:root{
  --bg:#eefaf2;
  --card:#ffffff;
  --ink:#0f172a;
  --muted:#5b6475;
  --line:#e6edf5;
  --brand:#0b5fa5;
  --brand2:#0a4f8a;
  --good:#16a34a;
  --bad:#ef4444;
  --shadow: 0 18px 55px rgba(2,6,23,.08);
  --radius: 18px;
  --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:"Cairo", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  color:var(--ink);
  background:
    radial-gradient(1200px 500px at 70% -20%, rgba(11,95,165,.14), transparent 55%),
    radial-gradient(900px 420px at 10% 0%, rgba(10,79,138,.12), transparent 55%),
    linear-gradient(#ffffff, #f1fbf5 40%, var(--bg));
}
.ksu-header{background:linear-gradient(180deg, var(--brand), var(--brand2));color:white;}
.ksu-bar{height:6px;background:rgba(255,255,255,.2)}
.ksu-wrap{
  max-width:1150px;margin:0 auto;padding:18px 18px 16px;
  display:flex;align-items:center;justify-content:space-between;gap:16px;
}
.ksu-brand{display:flex;align-items:center;gap:14px}
.ksu-mark{
  width:44px;height:44px;border-radius:14px;background:rgba(255,255,255,.18);
  position:relative;box-shadow:inset 0 0 0 1px rgba(255,255,255,.25);
}
.ksu-mark::before{content:"";position:absolute;inset:10px;border-radius:10px;background:rgba(255,255,255,.18);}
.ksu-titles .ar{font-weight:800;font-size:18px;letter-spacing:.2px}
.ksu-titles .en{font-weight:600;font-size:14px;opacity:.95}
.ksu-titles .sub{font-size:13px;opacity:.92;display:flex;gap:10px;align-items:center}
.ksu-titles .sep{opacity:.6}
.ksu-lesson{text-align:left}
.lesson-top{font-weight:700;font-size:13px;opacity:.92}
.lesson-main{font-weight:900;font-size:18px;letter-spacing:.3px}
.lesson-sub{font-size:12px;opacity:.9}
.page{max-width:1150px;margin:0 auto;padding:22px 18px 28px}
.shell{display:grid;grid-template-columns: 1fr 280px;gap:16px;align-items:start}
@media (max-width: 980px){ .shell{grid-template-columns:1fr} .ksu-lesson{display:none} }
.chat-card, .side-card{background:var(--card);border:1px solid var(--line);box-shadow:var(--shadow);border-radius:var(--radius);}
.chat-card{overflow:hidden}
.chat-head{
  padding:14px 16px;display:flex;align-items:center;justify-content:space-between;gap:12px;
  border-bottom:1px solid var(--line);background:linear-gradient(180deg, #ffffff, #fbfdff);
}
.chip{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;border:1px solid var(--line);font-weight:700;font-size:13px;color:var(--brand2);background:#f4f8ff;}
.status{display:flex;align-items:center;gap:8px;color:var(--muted);font-size:13px}
.dot{width:10px;height:10px;border-radius:50%;background:var(--good);box-shadow:0 0 0 4px rgba(22,163,74,.12)}
.dot.off{background:var(--bad);box-shadow:0 0 0 4px rgba(239,68,68,.12)}
.chat-body{
  padding:18px 16px;height: 420px;overflow:auto;
  background:radial-gradient(500px 220px at 80% 20%, rgba(11,95,165,.07), transparent 60%),
             radial-gradient(420px 200px at 10% 70%, rgba(10,79,138,.05), transparent 60%);
}
.msg{display:flex;gap:10px;margin:12px 0}
.msg .bubble{max-width:92%;padding:12px 14px;border-radius:16px;border:1px solid var(--line);background:#fff;box-shadow:0 8px 18px rgba(2,6,23,.05);}
.msg.user{justify-content:flex-start}
.msg.user .bubble{background:#f4f8ff;border-color:#d9e7ff}
.msg.bot{justify-content:flex-end}
.msg.bot .bubble{background:#f5fbf7;border-color:#d9f0e2}
.content{white-space:normal;line-height:1.85;direction:rtl;unicode-bidi:plaintext}
.content p{margin:10px 0}
.content ul,.content ol{margin:10px 0 10px 0;padding-right:22px}
.content li{margin:6px 0}
.content table{width:100%;border-collapse:collapse;margin:10px 0;background:#fff;border:1px solid var(--line);border-radius:12px;overflow:hidden}
.content th,.content td{border-bottom:1px solid var(--line);padding:10px 10px;font-size:14px;vertical-align:top}
.content th{background:#f4f8ff;font-weight:900}
.content tr:last-child td{border-bottom:none}
.content code{font-family:var(--mono);font-size:12.5px;direction:ltr}
.meta{font-size:12px;color:var(--muted);margin-top:6px;display:flex;gap:10px;align-items:center;justify-content:flex-start}
.msg.bot .meta{justify-content:flex-end}
.pill{border:1px solid var(--line);background:#fff;padding:6px 10px;border-radius:999px;font-size:12px;cursor:pointer;}
.pill:hover{border-color:#cbd7e6}
.code{font-family:var(--mono);font-size:12.5px;direction:ltr;text-align:left;background:#0b1220;color:#eaf2ff;border-radius:12px;padding:10px 12px;overflow:auto}
.chat-tools{padding:10px 14px;border-top:1px solid var(--line);border-bottom:1px solid var(--line);display:flex;gap:10px;flex-wrap:wrap;align-items:center;background:#ffffff;}
.select{font-family:inherit;border:1px solid rgba(0,0,0,0.12);border-radius:12px;padding:8px 10px;background:rgba(255,255,255,0.85);max-width:220px;}
.tool{display:inline-flex;align-items:center;gap:8px;padding:9px 12px;border-radius:12px;border:1px solid var(--line);background:#fff;cursor:pointer;font-weight:700;color:var(--ink);}
.tool:hover{border-color:#cbd7e6}
.tool .icon{font-size:16px}
.tool-check{user-select:none}
.tool-check input{accent-color: var(--brand);}
.chat-input{padding:12px 14px;display:flex;gap:10px;align-items:flex-start;}
#q{width:100%;resize:vertical;min-height:52px;border-radius:14px;border:1px solid var(--line);padding:12px 12px;font-size:14px;outline:none;background:#fff;}
#q:focus{border-color:#bfd4f3;box-shadow:0 0 0 4px rgba(11,95,165,.10)}
#send{border:none;padding:12px 16px;border-radius:14px;background:linear-gradient(180deg, var(--brand), var(--brand2));color:white;font-weight:900;cursor:pointer;box-shadow:0 14px 26px rgba(11,95,165,.22);}
#send:hover{filter:brightness(1.02)}
#send:disabled{opacity:.6;cursor:not-allowed}
.hint{padding:0 14px 14px;color:var(--muted);font-size:12px;}
.side-card{padding:14px}
.side-title{font-weight:900;color:var(--brand2);margin-bottom:10px}
.quick{width:100%;border:1px solid var(--line);background:#fff;border-radius:14px;padding:10px 12px;cursor:pointer;font-weight:700;margin:8px 0;text-align:right;}
.quick:hover{border-color:#cbd7e6}
.footer{padding:18px 18px 26px;color:var(--muted);font-size:12px;}
.foot-wrap{max-width:1150px;margin:0 auto;display:flex;gap:10px;align-items:center;justify-content:center;flex-wrap:wrap}
.footer .sep{opacity:.6}
.muted{opacity:.85}
.katex-display{direction:ltr;text-align:left}
.katex{direction:ltr}

/* شارة (رسم) الذكاء في منتصف الهيدر */
.topbar{ position: relative; }
.ai-badge{
  position:absolute;
  left:50%;
  top:10px;
  transform:translateX(-50%);
  width:48px;
  height:48px;
  display:flex;
  align-items:center;
  justify-content:center;
  border:1px solid rgba(20,20,20,.08);
  border-radius:14px;
  background:rgba(255,255,255,.85);
  color:var(--ksu);
  box-shadow:0 10px 30px rgba(2,6,23,.08);
  backdrop-filter: blur(6px);
}
@media (max-width: 720px){
  .ai-badge{ display:none; }
}
